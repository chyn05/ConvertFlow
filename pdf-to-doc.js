document.addEventListener('DOMContentLoaded',function(){const input=document.getElementById('pdfToDocInput');const btn=document.getElementById('pdfToDocButton');const status=document.getElementById('pdfToDocStatus');const dl=document.getElementById('pdfToDocDownload');btn&&btn.addEventListener('click',async()=>{if(!input.files[0]){status.textContent='Select PDF';return;}status.textContent='Extracting...';try{const arr=await input.files[0].arrayBuffer();const pdf=await pdfjsLib.getDocument({data:arr}).promise;let text='';for(let i=1;i<=pdf.numPages;i++){const page=await pdf.getPage(i);const tc=await page.getTextContent();text+=tc.items.map(it=>it.str).join(' ')+'\n\n';}const safe=text.replace(/</g,'&lt;');const html=`<html><head><meta charset="utf-8"></head><body><pre>${safe}</pre></body></html>`;const blob=new Blob([html],{type:'application/msword'});dl.href=URL.createObjectURL(blob);dl.style.display='inline-block';status.textContent='Done';}catch(e){console.error(e);status.textContent='Error';}});});