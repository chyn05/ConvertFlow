document.addEventListener('DOMContentLoaded',function(){const input=document.getElementById('signPdfInput');const sigInput=document.getElementById('signatureImage');const btn=document.getElementById('placeSigBtn');const dl=document.getElementById('sigDownload');const status=document.getElementById('signStatus');btn&&btn.addEventListener('click',async()=>{if(!input.files[0]) return status.textContent='Select PDF';if(!sigInput.files[0]) return status.textContent='Select signature image';status.textContent='Applying signature...';try{const { PDFDocument }=PDFLib;const arr=await input.files[0].arrayBuffer();const src=await PDFDocument.load(arr);const sigArr=await sigInput.files[0].arrayBuffer();const out=await PDFDocument.create();const img = await out.embedPng(sigArr).catch(()=>out.embedJpg(sigArr));for(let i=0;i<src.getPageCount();i++){const [copied]=await out.copyPages(src,[i]);const { width, height } = copied.getSize(); const imgDims = img.scale(0.2); copied.drawImage(img,{x:width-imgDims.width-40,y:40,width:imgDims.width,height:imgDims.height}); out.addPage(copied);}const bytes=await out.save();dl.href=URL.createObjectURL(new Blob([bytes],{type:'application/pdf'}));dl.style.display='inline-block';status.textContent='Done';}catch(e){console.error(e);status.textContent='Error';}});});